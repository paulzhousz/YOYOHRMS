@*@model YOYO.HRMS.Web.ViewModels.UserViewModel
*@@{
    Layout = null;           
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>YoYo HRMS</title>
    <link href="@Url.Content("~/Content/Jquery/plugin/jquery.easyui/themes/default/easyui.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/Jquery/plugin/jquery.easyui/themes/icon.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/Default.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/CSS/User_Login.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Content/jquery/jquery-1.7.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/Jquery/plugin/jquery.easyui/jquery.easyui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/Jquery/plugin/jquery.form/jquery.form.js")" type="text/javascript"></script>

   
    <script src="@Url.Content("~/Content/Scripts/YoYo.js")" type="text/javascript"></script>
  @*<script src="@Url.Content("~/Content/Scripts/EasyUIExt.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/jquery/plugin/jquery.validate/jquery.validate.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/jquery/plugin/jquery.validate/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
*@
    <script type="text/javascript">
            //当用户刷新页面触发的方法
        $(function () {
            //form初始化
            InitForm();
           
        });

            //Form 初始化
            function InitForm() {
                
                //公司列表初始化
                $('#corporateList').combobox({
                    url: '@Url.Content("~/Home/GetCorporateList")',
                    valueField: 'corporateID',
                    textField: 'corporateName',
                    editable: false,
                    required: true,
                    missingMessage: '@T("required", true)',
                    onLoadSuccess: function () {
                        var data = $('#corporateList').combobox('getData');
                        if (data.length > 0) {
                            $('#corporateList').combobox('select', data[0].corporateID);
                        }
                    }
                });

                //Form 提交
                $('#LoginForm').form({
                    url: '@Url.Content("~/Home/LoginAndRedirect")',
                    onSubmit: function () {
                        var isValid = $(this).form('validate');
                        if (!isValid) {
                            //$.messager.progress('close'); // 当form不合法的时候隐藏工具条
                        }
                        return isValid;
                    },
                    success: function (data) {
                        var data = $.parseJSON(data);
                        if (!data.Result) {
                            //YoYo.Tips('Error', data.Message);
                            $.messager.alert(data.Title, data.Message, 'error');
                            return false;
                        }
                        else {
                            location.href = "@Url.Content("~/Home/Index")";
                        }
                    }
                });
                              
                //数据校验规则
                $('#usercode').validatebox({
                    required: true,
                    missingMessage: '@T("required", true)'
                });  

                $('#userpwd').validatebox({
                    required: true,
                    missingMessage: '@T("required", true)'
                });

                //登陆按钮初始化
                $('#btnLogin').click(function(){
                    //$.messager.progress(); // 显示一个进度条 
                    $('#LoginForm').form('submit');
                });
            }

        

    </script>
</head>
<body id="userlogin_body">
    <form id="LoginForm" method="post">
    <div id="user_login">
        <dl>
            <dd id="user_top">
                <ul>
                    <li class="user_top_l"></li>
                    <li class="user_top_c"></li>
                    <li class="user_top_r"></li>
                </ul>
                <dd id="user_main">
                    <ul>
                        <li class="user_main_l"></li>
                        <li class="user_main_c">
                            <div class="user_main_box">
                                <ul>
                                    <li class="user_main_text">@T("Login Corporate", false) </li>
                                    <li class="user_main_input">
                                        <input id="corporateList" name="corporateList" class="easyui-combobox" height="auto" />
                                    </li>
                                </ul>
                                <ul>
                                    <li class="user_main_text">@T("UserCode", false) </li>
                                    <li class="user_main_input">
                                        <input id="usercode" name="usercode"  />
                                    </li>
                                </ul>
                                <ul>
                                    <li class="user_main_text">@T("UserPassword", false)</li>
                                    <li class="user_main_input">
                                        <input id="userpwd" name="userpwd" />
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li class="user_main_r">
                            <input type="image" class="IbtnEnterCssClass" id="btnLogin" name="btnLogin" src="@Url.Content("~/Content/images/user_botton.gif")">
                        </li>
                    </ul>
                    <dd id="user_bottom">
                        <ul>
                            <li class="user_bottom_l"></li>
                            <li class="user_bottom_c"><span style="margin-top: 40px">YoYo Father</span> </li>
                            <li class="user_bottom_r"></li>
                        </ul>
                    </dd>
        </dl>
    </div>
    </form>
</body>
</html>
